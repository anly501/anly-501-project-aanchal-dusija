<HTML>
	<head>
		<link rel="stylesheet" href="../styles1.css">
	  </head>

	<body>
	    <a href="https://analytics.georgetown.edu/"><img src="https://ngpardeshi.georgetown.domains/ANLY 501 IMAGES/DSA.jpg" style="width:600px;height:200px;" /> 
			<img src="https://ngpardeshi.georgetown.domains/ANLY 501 IMAGES/GU_Background.png" style="width:700px;height:200px;" align="right">
		 </a> 
	<ul class ="header">
		<!-- link back to homepage -->
		<li><a href="../index.html">About me</a></li>
		
		<!-- tab without drpdown  -->
		<li><a href="../pages/introduction.html">Introduction</a></li>
		<li><a href="../pages/DataGathering.html">Data Gathering</a></li>
		<li><a href="https://github.com/anly501/anly-501-project-aanchal-dusija">Data</a></li>
		<li><a href="https://github.com/anly501/anly-501-project-aanchal-dusija">Code</a></li>
		<li><a href="../pages/DataCleaning.html">Data Cleaning</a></li>
		<li><a href="../pages/Data Viz.html">Exploring Data</a></li>
		<li class="drpdown">
			<a href="javascript:void(0)" class="drpbtn">Naive Bayes</a>
		
			<div class="drpdown-content">
			<a href="../pages/NBinR.html" >Naive Bayes in R</a>
			<a href="../pages/NBinPy_quarto.html" >Naive Bayes in Python</a>
			</div>
		</li>
		<li><a href="../pages/Clustering.html">Clustering</a></li>
		<li><a href="../pages/ARM.html">ARM and Networking</a></li>
		<li><a href="../pages/DT.html">Decision Trees</a></li>
		<!-- <li><a href="../pages/xyz.html">Naive Bayes</a></li> -->
		<li><a href="../pages/SVM.html">SVM</a></li>
		<li><a href="../pages/Conclusion.html">Conclusions</a></li>
		
	</ul>

  <!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.246">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Naive Bayes for Record Data in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="NBinR_files/libs/clipboard/clipboard.min.js"></script>
<script src="NBinR_files/libs/quarto-html/quarto.js"></script>
<script src="NBinR_files/libs/quarto-html/popper.min.js"></script>
<script src="NBinR_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="NBinR_files/libs/quarto-html/anchor.min.js"></script>
<link href="NBinR_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="NBinR_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="NBinR_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="NBinR_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="NBinR_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Naive Bayes for Record Data in R</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="what-is-naive-bayes" class="level3">
<h3 class="anchored" data-anchor-id="what-is-naive-bayes"><strong>What is Naive Bayes?</strong></h3>
<p>It is a classification technique based on Bayes Theorem with an assumption of independence among predictors. In simple terms, a Naive Bayes classifier assumes that the presence of a particular feature in a class is unrelated to the presence of any other feature. Naive Bayes model is easy to build and particularly useful for very large data sets. Along with simplicity, Naive Bayes is known to outperform even highly sophisticated classification methods.</p>
<p>This page will look at Naive Bayes Classification, Attribute Selection Measures, and how to build and optimize a Naive Bayes Classifier using R. Naive Bayes is a simple method for developing classifiers, which are models that assign class labels to problem cases represented as vectors of feature values, with the class labels chosen from a small set. There is no single algorithm for training such classifiers, but rather a collection of algorithms based on the same principle: all naive Bayes classifiers assume that the value of one feature is independent of the value of any other feature, given the class variable. This page contains the Naive Bayes code and visualizations done in R for Record data</p>
</section>
<section id="assumption-for-naive-bayes" class="level2">
<h2 class="anchored" data-anchor-id="assumption-for-naive-bayes">Assumption for Naive Bayes:</h2>
<p>The Naive Bayes algorithm makes the assumption that the predictors are independent of each other. In real life, it is almost impossible that we get a set of predictors which are completely independent.</p>
</section>
<section id="types-of-naive-bayes-classifier" class="level2">
<h2 class="anchored" data-anchor-id="types-of-naive-bayes-classifier">Types of Naive Bayes Classifier:</h2>
<p> Multinomial Naive Bayes: This is mostly used to determine how to place a document into a certain category, such as sports, politics, technology, etc. The frequency of the words in the document is one of the things that the classifier looks at.</p>
<p>Bernoulli Naive Bayes: This is comparable to the multinomial naive bayes model, with the exception that the predictors are boolean variables. The parameters that we use to predict the class variable take on simply yes or no values, such as whether or not a word appears in the text.</p>
<p>Gaussian Naive Bayes: When predictors have continuous values and are not discrete, these values are assumed to be drawn from a Gaussian distribution.</p>
</section>
<section id="advantages-of-naive-bayes" class="level2">
<h2 class="anchored" data-anchor-id="advantages-of-naive-bayes">Advantages of Naive Bayes</h2>
<p> This algorithm is efficient and can save a great deal of time.</p>
<p> The Naive Bayes method can be used to solve multiclass prediction issues.</p>
<p> If the model's assumption on the independence of characteristics remains true, it can outperform competing models and requires significantly less training data.</p>
<p> The Naive Bayes algorithm is more suitable for category input variables than numerical ones.</p>
</section>
<section id="disadvantages-of-naive-bayes" class="level2">
<h2 class="anchored" data-anchor-id="disadvantages-of-naive-bayes">Disadvantages of Naive Bayes</h2>
<p>  Bayes assumes that all predictors (or features) are independent, which rarely happens in real life. This makes it harder for this algorithm to be used in the real world.</p>
<p>The zero-frequency problem is when this algorithm gives a probability of 0 to a categorical variable whose category in the test data set wasn't in the training data set. The best way to solve this problem would be to use a smoothing method.</p>
<p>ts estimations can be wrong in some cases, so you shouldn't take its probability outputs very seriously.</p>
</section>
<section id="naive-bayes-in-r" class="level2">
<h2 class="anchored" data-anchor-id="naive-bayes-in-r"><strong>Naive Bayes in R</strong></h2>
<p>The naive bayes is created using Macy's dataset in R. It is the same record dataset used for decision trees. The dataset has been webscrapped from the Macy's official website. This dataset has been cleaned and now consists of various features like Rating, Average Price, Stock of each colour, Total Stock, and Price Type.The label column contains the data of whether the item is expensive (average price greater than or equal to $100) or reasonable(average price less than $100).</p>
</section>
<section id="clearing-environment" class="level1">
<h1>Clearing Environment</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="libraries" class="level2">
<h2 class="anchored" data-anchor-id="libraries">Libraries</h2>
<div class="cell">

</div>
</section>
<section id="loading-data" class="level2">
<h2 class="anchored" data-anchor-id="loading-data">Loading Data</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 20
  Brand   Category Color0 Color1 Color2 Color3 Color4 Color5 Rating URL   Average_Price
  &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;
1 Camper  Shoes   Multi… &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;     5    http…    NA  
2 Timbe Shoes   Black  Dark … &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;     4.58 http…    90.0
3 Weathe Men     Black  Rosin  Navy   Port   Pumpk… &lt;NA&gt;     0    http…    49  
4 Michae Casual… Black  White  Dark … Alloy… &lt;NA&gt;   &lt;NA&gt;     4.51 http…    62.6
5 Tommy Blazer… Brown  &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;     0    http…   140. 
6 Calvin Coats … Black  &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;     4.27 http…    95.6
# … with 9 more variables: C0_stock &lt;dbl&gt;, C1_stock &lt;dbl&gt;, C2_stock &lt;dbl&gt;,
#   C3_stock &lt;dbl&gt;, C4_stock &lt;dbl&gt;, C5_stock &lt;dbl&gt;, Total_stock &lt;dbl&gt;,
#   Gender &lt;chr&gt;, Price_type &lt;chr&gt;, and abbreviated variable names Category,
#   Average_Price</code></pre>
</div>
</div>
</section>
<section id="balancing-data" class="level2">
<h2 class="anchored" data-anchor-id="balancing-data">Balancing Data</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>macy_balanced <span class="ot">&lt;-</span> <span class="fu">ovun.sample</span>(Price_type<span class="sc">~</span>., <span class="at">data=</span>macy,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">N=</span><span class="fu">nrow</span>(macy), <span class="at">p=</span><span class="fl">0.5</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">seed=</span><span class="dv">1</span>, <span class="at">method=</span><span class="st">"both"</span>)<span class="sc">$</span>data</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(macy_balanced, <span class="dv">2</span>, table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$Rating

0.0000 1.0000 1.5000 1.6667 2.0000 2.2000 2.4000 2.6250 2.6667 2.7143 2.7500 
   583     21      6      2      1      1      3      2      2      3      1 
2.8571 2.8889 3.0000 3.1250 3.1724 3.1786 3.2041 3.2500 3.2578 3.2821 3.2857 
     1      1     37      1      2      1      3      3      1      1      2 
3.3333 3.4000 3.4118 3.4545 3.5000 3.5143 3.5938 3.6000 3.6667 3.7273 3.7500 
     3      3      3      1      8      2      2      1     10      4      2 
3.7708 3.7733 3.7925 3.8000 3.8182 3.8333 3.8750 3.8889 3.9000 3.9057 3.9444 
     1      1      4      1      3      2      1      3      1      2      4 
3.9552 3.9600 3.9733 3.9760 3.9815 4.0000 4.0094 4.0476 4.0488 4.0702 4.0736 
     2      1      1      1      2     71      2      1      3      1      1 
4.0833 4.0952 4.1019 4.1053 4.1111 4.1143 4.1176 4.1200 4.1240 4.1322 4.1341 
     3      1      3      3      1      4      1      3      4      2      2 
4.1429 4.1499 4.1500 4.1667 4.1724 4.1818 4.1840 4.1875 4.1944 4.2000 4.2030 
     4      3      1      5      1      1      1      1      1     14      1 
4.2059 4.2083 4.2105 4.2162 4.2192 4.2222 4.2308 4.2326 4.2391 4.2464 4.2500 
     1      1      3      3      1      8      4      2      1      2      4 
4.2571 4.2573 4.2589 4.2667 4.2707 4.2857 4.2925 4.2992 4.3077 4.3149 4.3152 
     1      1      2      3      1      3      2      3      6      1      2 
4.3315 4.3333 4.3371 4.3478 4.3488 4.3654 4.3714 4.3733 4.3750 4.3871 4.3913 
     1      6      2      1      3      2      1      2      1      1      4 
4.3958 4.4000 4.4001 4.4043 4.4063 4.4089 4.4104 4.4110 4.4150 4.4198 4.4211 
     1      3      1      2      1      3      3      1      2      2      1 
4.4333 4.4375 4.4394 4.4400 4.4444 4.4615 4.4682 4.4706 4.4709 4.4717 4.4762 
     3      4      2      1      1      2      2      2      1      8      2 
4.4878 4.5000 4.5116 4.5128 4.5131 4.5161 4.5167 4.5194 4.5222 4.5224 4.5227 
     4     24      1      4      3      1      1      1      1      1      1 
4.5260 4.5269 4.5383 4.5419 4.5476 4.5500 4.5517 4.5554 4.5563 4.5625 4.5641 
     1      1      4      1      1      2      2      1      6      1      3 
4.5649 4.5714 4.5739 4.5741 4.5767 4.5795 4.5804 4.5833 4.5858 4.5862 4.5938 
     3      3      4      2      2      2      1      1      3      1      1 
4.5957 4.5985 4.5987 4.6000 4.6049 4.6068 4.6087 4.6154 4.6207 4.6235 4.6250 
     3      2      1      7      3      1      2      1      6      1      1 
4.6364 4.6371 4.6396 4.6429 4.6471 4.6512 4.6559 4.6562 4.6596 4.6667 4.6842 
     4      1      2      4      2      4      4      1      1     16      2 
4.6875 4.6923 4.7000 4.7014 4.7041 4.7143 4.7188 4.7200 4.7347 4.7391 4.7436 
     2      1      9      3      2      5      1      2      4      2      1 
4.7500 4.7551 4.7586 4.7609 4.7639 4.7674 4.7778 4.7826 4.7895 4.8000 4.8023 
     8      1      2      1      1      3      2      3      1      6      1 
4.8033 4.8095 4.8182 4.8333 4.8385 4.8519 4.8571 4.8750 4.8889 4.9286 5.0000 
     6      2      2      6      1      2      3      2      2      4    168 

$Average_Price

    7.84000    10.49000    12.24000    13.65000    13.83000    14.00000 
          1           1           4           1           2           4 
   14.69000    15.00000    15.40000    15.75000    15.94000    16.80000 
          1           2           4           1           1           1 
   16.99000    17.49000    17.50000    17.55000    17.76000    18.89000 
          1           6           4           2           4           2 
   18.90200    19.13000    19.60000    19.99000    20.83000    20.99000 
          1           1           2           3           7           2 
   21.00000    22.01000    22.12000    22.26000    22.31000    24.00000 
          1           1           1           1           2           3 
   24.50000    25.06000    25.19000    25.20000    25.50000    25.89000 
          2           2           2           3           1           1 
   25.98000    26.20800    27.83000    27.99000    28.00000    28.61000 
          3           1           1           2           5           2 
   29.75000    29.80000    29.99000    30.40000    30.80000    31.18000 
          3           1           4           1           2           4 
   31.23000    31.50000    32.99000    33.18000    33.32000    33.59000 
          4           4           4           1           3           8 
   33.75000    34.13000    34.65000    34.99000    35.00000    35.70000 
          1           1           2           5           5           1 
   35.99000    36.41857    36.48000    36.49000    37.20000    37.80000 
          3           2          15           4           4           1 
   38.49000    38.50000    38.71000    38.92000    39.19000    39.20000 
          3           3           4           3           2           1 
   39.99000    40.57500    40.60000    41.25000    41.30000    41.35000 
          1           1           2           2           1           4 
   41.65000    41.73000    41.79000    41.84000    41.99000    42.00000 
         12           5           5           7           8           6 
   42.35667    43.61000    44.80000    44.99000    45.00000    45.06600 
          1           1           2           9           1           1 
   45.15000    45.49000    45.50000    45.99000    46.99000    47.01000 
          1           5           6           1           3           4 
   47.60000    47.78000    47.86000    48.02000    48.13000    48.30000 
          1           2           7           2           3           9 
   48.65000    48.75000    48.99000    49.77000    49.99000    50.00000 
          6           2           1           2           2           1 
   50.39000    50.40000    51.45000    52.13000    52.23000    52.50000 
          1           8           3           1           2           3 
   53.20000    53.25000    53.44000    53.54000    53.55000    54.60000 
          1           3           1           4           7           5 
   54.99000    55.30000    55.65000    55.99000    56.07000    56.25000 
          1           5          11           5           6           1 
   56.69000    56.70000    57.00000    57.40000    57.75000    58.79000 
          6           3           2           1           1           2 
   58.80000    59.40000    59.50000    59.62000    59.85000    59.95000 
          1           1           5           1           4           1 
   59.99000    60.00000    60.90000    61.25000    62.30000    62.37000 
          2           4           2           1           4           1 
   62.48000    62.50000    62.58000    62.65000    63.00000    64.99000 
          6           2           5           5           1           3 
   65.09667    66.50000    67.20000    67.38000    67.50000    67.72000 
          2           6           1           3           6          11 
   67.98000    68.60000    68.67000    69.30000    69.95000    69.99000 
          3           1           1           8           3          18 
   70.00000    70.31000    72.45000    72.97000    73.23000    73.49000 
          5           8           2           5           7           1 
   73.87000    74.66667    74.76000    74.99000    75.94000    76.30000 
          2           1           1          10           1           5 
   76.50000    76.65000    77.00000    77.63000    77.70000    77.84000 
          3           1           9           1           2           1 
   78.22000    78.26000    78.75000    79.99000    81.56000    81.90000 
          3           3           2           5           1           3 
   83.25000    83.30000    83.48000    84.00000    84.28000    84.38000 
          2           4           8           3           1           1 
   84.95000    84.99000    85.05000    85.50000    85.75000    87.50000 
          2           1          10           3           3           1 
   87.99000    88.00000    88.20000    88.73000    89.04000    89.10000 
          2           1           2           6           1           1 
   89.95000    89.99000    90.00000    90.30000    90.99000    93.10000 
          4           4           3          18           1           3 
   93.75000    93.79000    93.80000    93.98000    94.15000    94.61000 
          6           2           1           5           2           2 
   95.00000    95.55000    95.63000    96.25000    96.60000    97.29000 
          6           4           1           2           2           1 
   97.30000    97.34000    97.99000    98.00000    99.00000    99.90000 
         18           1           6           4           3           1 
   99.99000   100.80000   101.25000   103.59000   103.60000   104.30000 
          4          10           4           1           1           6 
  104.99000   105.00000   105.84000   106.88000   107.10000   108.00000 
          5           2           3           3           2           5 
  109.99000   110.25000   110.60000   110.88000   111.00000   111.30000 
          8          14           1           5           4           7 
  111.65000   112.50000   114.98000   115.49000   116.55000   116.76000 
          2           6           2           4           1           2 
  117.00000   118.13000   118.30000   119.00000   119.99000   120.00000 
          4           6           8           2           7           2 
  122.50000   123.20000   123.75000   124.60000   125.10000   125.30000 
          6           4           1           7           2           2 
  125.47500   125.65000   127.39000   129.49000   129.50000   129.99000 
          4           2           1           4           5           5 
  130.50000   131.60000   132.00000   132.30000   132.65000   134.75000 
          2           2           2           7           4           1 
  135.00000   138.60000   139.30000   139.50000   139.99000   140.00000 
          6           2          22           2           8           2 
  140.63000   144.00000   144.20000   144.38000   144.55000   145.24500 
          1           1           2           3           4           1 
  146.25000   146.30000   146.99000   147.00000   148.50000   149.64000 
          1           2           1           2           3           1 
  150.00000   150.49000   151.88000   153.30000   154.00000   157.49000 
          7           2           3           9           9           6 
  157.50000   159.60000   160.30000   161.00000   161.25000   161.70000 
         14           1           8           1           1           3 
  163.63000   164.49000   165.00000   166.60000   167.30000   167.65000 
          6           5           2           2           3           1 
  167.76667   167.99000   168.00000   170.00000   170.10000   173.60000 
          1          10           2           1           2           7 
  174.30000   176.40000   177.80000   178.49000   179.20000   180.00000 
         29           1           3           2           3           2 
  180.60000   181.30000   183.75000   185.50000   187.60000   188.99000 
          1          13           1           1           1           2 
  189.00000   192.49000   192.50000   195.00000   195.30000   199.49000 
          2           1           3           5          15           2 
  199.99000   202.30000   202.99000   205.10000   206.25000   206.50000 
          2           5           1           2           1           3 
  208.60000   209.30000   210.00000   210.70000   210.94000   211.75000 
          3          10           2           1           1           7 
  220.49000   220.50000   221.25000   221.38000   222.19000   223.30000 
          4           8           9           1           7           3 
  225.00000   228.20000   230.30000   230.99000   231.00000   231.70000 
         13           3           8           2           7           1 
  236.25000   237.30000   238.00000   239.06000   241.49000   241.50000 
          2           1           1           1           5           4 
  244.30000   245.00000   250.25000   251.30000   262.50000   263.90000 
          5           3           2           1           2           1 
  269.50000   270.94000   279.65000   286.99000   291.55000   303.10000 
          1           2           2           2           6           2 
  308.00000   311.50000   314.30000   325.50000   332.50000   346.50000 
          1           3           3           2           5           1 
  356.25000   364.00000   367.50000   371.25000   375.38000   385.00000 
          1           1           6           3           1           4 
  398.65000   420.00000   423.50000   446.25000   462.00000   462.19000 
          2           1           3           1           1           1 
  468.75000   486.50000   506.81000   539.00000   562.50000   577.50000 
          9           3           1           3           3           1 
  629.37000   654.15000   699.30000   840.00000   909.30000   944.37000 
          1           3           4           2           1           1 
  974.05000  1251.25000  1732.50000  3850.00000 10196.25000 13121.25000 
          3           3           2           1           2           3 

$C0_stock

  0   1   2   3   5   6   7   8   9  10  14  15  17  20  21  24  25  26  27  28 
391  28  59  22  57  30   2   3  83 125  97  44   2  57  29   2   1   3  37   6 
 34  35  36  44  45  55  60  65  66  67  69  72  78  91 104 105 111 119 120 121 
  1  49   9  10  32  16   2   3  47   1   1   1  14   7   1   7   2   3  12   1 
125 133 136 153 171 174 175 185 190 192 203 209 210 230 231 253 275 276 290 300 
  2   1  17  19   3   2   1   3  10   1   1   4   7   4   7   6   1   3   2  10 
307 312 318 326 353 382 444 453 594 
  1   4   3   1   5   3   3   4   4 

$C1_stock

  0   1   2   3   4   5   6   7   9  10  12  13  15  18  19  20  21  23  25  28 
838  21   5  33   7   2  47   3   5 114   1   1  59   4   2   1  33   7   1  11 
 29  32  33  36  37  39  40  43  44  45  51  53  55  65  66  67  71  72  73  78 
  1   1   4   8   1   4   1   6   1  18   2   3   3   2  34   1   1   1   1   8 
 85  89  91  98 105 111 120 121 128 129 130 135 136 151 153 168 190 210 211 212 
  1   4   1   2   6   2  12   2   2   1   1   2   4   3  12   2  11  10   1   3 
217 218 230 231 237 274 275 278 282 286 301 303 312 328 351 357 364 386 399 401 
  5   1   1   4   4   3   1   2   2   2   3   1   1   4   1   2   1   1   2   1 
425 447 448 498 703 
  2   1   1   1   4 

$C2_stock

   0    1    2    3    4    5    6    7    8    9   10   11   13   14   15   20 
1080    7    2   15   10    2   16    3    1    2   70    4    2    2   45    1 
  21   24   28   30   33   36   37   38   41   45   50   60   66   72   73   74 
  14    2    9    1    1    2    1    1    1   15    2    1   12    1    1    1 
  76   78   85   88   91   97  100  104  115  120  123  126  131  136  137  146 
   1    1    1    1    3    1    5    1    4    4    2    1    2    8    1    2 
 152  153  154  156  165  166  171  181  190  198  199  205  212  215  226  231 
   1    5    1    2    3    3    6    2    3    4    1    3    1    4    3    1 
 244  247  268  300  421  493  500  517  540 
   2    4    6    2    1    1    2    2    1 

$C3_stock

   0    1    3    4    5    6    7    8    9   10   11   12   15   20   21   25 
1199    2    4    6    1   11    1    1    9   35    2    3   40    1    4    3 
  28   30   38   44   45   55   66   72   73   78   91  108  109  117  126  129 
  10    1    3    1    3    4    8    1    3    4    1    1    3    3    1    1 
 136  138  143  147  153  155  171  172  190  192  202  204  210  222  226  241 
   4    1    4    1    2    2    9    6    2    1    1    3    1    6    3    2 
 245  299  322  436  467  472 
   1    4    1    1    2    2 

$C4_stock

   0    3    6    8   10   12   14   15   16   20   21   28   30   32   33   34 
1268    4    5    3   38    2    2   22    1    2    4    9    2    1    2    2 
  45   47   64   66   70   77   78   82  102  105  107  126  136  153  169  189 
   3    4    4    3    1    3    1    2    3    3    4    1    2    7    1    1 
 190  223  230  279  293  300  310  321  322  332 
   1    4    1    1    2    2    1    4    1    2 

$C5_stock

   0    1    4    6    8   10   12   13   14   15   17   19   20   21   55   58 
1322    1    1    9    2   26    2    3    4   23    3    3    1    2    2    2 
  62   63   64   82  107  136  153  155  225  230  252  368  464  480 
   2    1    1    1    4    1    1    1    2    1    4    1    1    2 

$Total_stock

   0    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15 
 348   26   40   27    2   43   16    1    5   58   44    8   14    1   50   25 
  16   17   18   19   20   21   22   23   24   25   26   27   28   29   30   31 
  13    3    3   11   64   13    1    1    3    1    1   34    5   17   15    1 
  32   34   35   36   38   39   40   41   42   44   45   46   47   48   49   50 
   1    3   50    8    5    1    4    3    9   12   10    5    2    3    2    7 
  51   52   53   54   55   56   57   59   60   62   63   66   68   69   70   71 
   2    1    7    2    7    4    3    5    2    4    1   16    2    1    5    4 
  72   74   75   78   79   81   83   84   88   89   90   91   92   94   95   96 
   2    5    8    9    1    3    1    2    6    6    2    6    3    1    2    1 
  98   99  100  101  102  104  105  106  108  113  116  117  118  120  121  123 
   2    1    1    5    5    3    8    1    2    1    2    2    1    2    2    2 
 132  133  134  135  136  137  139  141  142  143  145  147  153  156  162  165 
  23    3    4    2    8    3    2    2    1    2    1    1    6    6    4    1 
 171  180  187  195  198  201  207  210  231  239  245  248  253  276  279  291 
   1    3    3    3    4    1    2    2    2    1    2    1    3    3    1    2 
 300  306  309  315  326  360  364  374  376  380  384  392  407  408  415  419 
   1    1    3    1    1    4    1    2    2    1    1    1    1    1    4    1 
 420  428  434  436  438  442  443  444  461  462  468  471  477  478  480  511 
   1    1    4    1    2    2    1    2    1    1    5    3    1    1    1    2 
 512  519  549  565  570  578  601  605  606  612  638  646  652  653  659  711 
   2    2    4    1    1    3    3    1    2    3    4    4    1    1    2    3 
 743  746  749  790  816  829  849  892  938  956  957  962 1001 1023 1043 1048 
   1    1    3    1    1    1    1    1    1    1    1    3    3    6    1    1 
1140 1254 1297 1594 1611 1676 1761 2156 2642 3317 4136 
   2    4    4    2    4    1    1    2    2    1    1 

$Price_type

 Expensive Reasonable 
       678        751 </code></pre>
</div>
</div>
</section>
</section>
<section id="exploratory-data-analysis" class="level1">
<h1>Exploratory data analysis</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(macy_balanced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              vars    n   mean     sd median trimmed   mad  min      max
Rating           1 1429   2.51   2.18   3.73    2.52  1.89 0.00     5.00
Average_Price    2 1429 173.85 723.38  97.30  107.78 73.42 7.84 13121.25
C0_stock         3 1429  36.95  75.94  10.00   17.29 14.83 0.00   594.00
C1_stock         4 1429  27.13  74.18   0.00    7.61  0.00 0.00   703.00
C2_stock         5 1429  16.74  56.00   0.00    2.04  0.00 0.00   540.00
C3_stock         6 1429  12.06  47.80   0.00    0.71  0.00 0.00   472.00
C4_stock         7 1429   7.70  37.14   0.00    0.12  0.00 0.00   332.00
C5_stock         8 1429   4.11  30.81   0.00    0.00  0.00 0.00   480.00
Total_stock      9 1429 108.65 293.05  16.00   37.40 23.72 0.00  4136.00
Price_type*     10 1429   1.53   0.50   2.00    1.53  0.00 1.00     2.00
                 range  skew kurtosis    se
Rating            5.00 -0.20    -1.84  0.06
Average_Price 13113.41 15.88   264.55 19.14
C0_stock        594.00  3.55    15.08  2.01
C1_stock        703.00  4.52    26.50  1.96
C2_stock        540.00  5.02    31.43  1.48
C3_stock        472.00  5.53    36.62  1.26
C4_stock        332.00  6.47    45.16  0.98
C5_stock        480.00 11.25   143.92  0.82
Total_stock    4136.00  5.90    50.46  7.75
Price_type*       1.00 -0.10    -1.99  0.01</code></pre>
</div>
</div>
</section>
<section id="splitting-test-and-train" class="level1">
<h1>Splitting test and train</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>indxTrain <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(<span class="at">y =</span> macy_balanced<span class="sc">$</span>Price_type,<span class="at">p =</span> <span class="fl">0.75</span>,<span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>training <span class="ot">&lt;-</span> macy_balanced[indxTrain,]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>testing <span class="ot">&lt;-</span> macy_balanced[<span class="sc">-</span>indxTrain,] <span class="co">#Check dimensions of the split &gt; pro</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="feature-scaling" class="level1">
<h1>Feature Scaling</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> training[,<span class="sc">-</span><span class="dv">10</span>]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> training<span class="sc">$</span>Price_type</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="model-building" class="level1">
<h1>Model Building</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">=</span> <span class="fu">train</span>(x,y,<span class="st">'nb'</span>,<span class="at">trControl=</span><span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">'cv'</span>,<span class="at">number=</span><span class="dv">10</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Naive Bayes 

1073 samples
   9 predictor
   2 classes: 'Expensive', 'Reasonable' 

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 966, 966, 965, 966, 966, 965, ... 
Resampling results across tuning parameters:

  usekernel  Accuracy   Kappa    
  FALSE      0.5656196  0.1620140
   TRUE      0.8480703  0.6995788

Tuning parameter 'fL' was held constant at a value of 0
Tuning
 parameter 'adjust' was held constant at a value of 1
Accuracy was used to select the optimal model using the largest value.
The final values used for the model were fL = 0, usekernel = TRUE and adjust
 = 1.</code></pre>
</div>
</div>
</section>
<section id="prediction" class="level1">
<h1>Prediction</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(model,<span class="at">newdata =</span> testing ) <span class="co">#Get the confusion matrix to see accuracy value and other parameter values &gt; </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="variable-importance-plot" class="level1">
<h1>Variable Importance Plot</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">varImp</span>(model)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NBinR_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="confusion-matrix" class="level1">
<h1>Confusion Matrix</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(<span class="fu">as.factor</span>(testing<span class="sc">$</span>Price_type), Predict)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   Expensive Reasonable
  Expensive        167          2
  Reasonable        56        131
                                          
               Accuracy : 0.8371          
                 95% CI : (0.7945, 0.8739)
    No Information Rate : 0.6264          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.6783          
                                          
 Mcnemar's Test P-Value : 3.421e-12       
                                          
            Sensitivity : 0.7489          
            Specificity : 0.9850          
         Pos Pred Value : 0.9882          
         Neg Pred Value : 0.7005          
             Prevalence : 0.6264          
         Detection Rate : 0.4691          
   Detection Prevalence : 0.4747          
      Balanced Accuracy : 0.8669          
                                          
       'Positive' Class : Expensive       
                                          </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>plt <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(cm<span class="sc">$</span>table)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>plt<span class="sc">$</span>Prediction <span class="ot">&lt;-</span> <span class="fu">factor</span>(plt<span class="sc">$</span>Prediction, <span class="at">levels=</span><span class="fu">rev</span>(<span class="fu">levels</span>(plt<span class="sc">$</span>Prediction)))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plt, <span class="fu">aes</span>(Prediction,Reference, <span class="at">fill=</span> Freq)) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>Freq)) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">"white"</span>, <span class="at">high=</span><span class="st">"#009194"</span>) <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Reference"</span>,<span class="at">y =</span> <span class="st">"Prediction"</span>) <span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Expensive"</span>,<span class="st">"Reasonable"</span>,<span class="st">"Expensive"</span>,<span class="st">"Reasonable"</span>)) <span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Reasonable"</span>,<span class="st">"Expensive"</span>,<span class="st">"Reasonable"</span>,<span class="st">"Expensive"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="NBinR_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>